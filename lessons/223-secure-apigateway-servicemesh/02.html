<section class="card" id="section-2">
  <div class="card-header">2. Intuitive Hook</div>
  <div class="card-body">
    <p>
      Imagine zero-trust traffic management as an airport where every passenger and aircraft is continuously verified: the API gateway is the security
      checkpoint that inspects people and baggage at the perimeter, while the service mesh is the air-traffic control system that supervises each runway,
      taxiway, and flight path inside the airport. The combination keeps untrusted actors from boarding and ensures approved flights never collide or
      deviate from their assigned corridors, exactly how BeyondCorp policies require identity-aware ingress and Istio enforces encrypted, policy-driven
      service-to-service hops.
    </p>
    <div class="callout callout-success">
      <strong>Analogy ‚Üí Responsibility Map:</strong>
      <ul>
        <li><strong>Security checkpoint (API gateway):</strong> validates badge, luggage, and destination context before a traveler steps past the terminal boundary, mirroring BeyondCorp-style continuous verification of user + device posture before allowing any API call into the mesh perimeter.</li>
        <li><strong>Air-traffic control (service mesh):</strong> tracks every authorized aircraft, issues per-runway clearances, and reacts instantly to anomalies, just like Istio sidecars that enforce mutual TLS, rate limits, and circuit-breaking for every intra-mesh hop.</li>
        <li><strong>Shared flight manifest (gateway + mesh telemetry):</strong> lets airport ops reconstruct the entire journey, analogous to propagating trace headers and policy decisions from the gateway to the mesh for deep observability.</li>
      </ul>
    </div>
    <p>
      Use the flow below to narrate the sequence from the first badge swipe at the gateway to how the mesh steers the call safely between services.
    </p>
    <div id="section-2-flow" class="widget"></div>
    <p>
      Key takeaways:
    </p>
    <ol>
      <li>The gateway filters intent at the edge, normalizes metadata, and ensures requests meet BeyondCorp-style contextual policies before they touch microservices.</li>
      <li>The mesh keeps enforcing inside the trust boundary‚Äîmutual TLS, retries, traffic splitting‚Äîakin to how controllers guide every aircraft minute-by-minute.</li>
      <li>Telemetry stitched across both layers is what proves compliance and fuels rapid incident response.</li>
    </ol>
    <div class="reference-list">
      <strong>References:</strong>
      <ul>
        <li><a href="https://cloud.google.com/beyondcorp" target="_blank" rel="noopener">Google BeyondCorp Enterprise overview</a> ‚Äî identity-aware access control at the edge.</li>
        <li><a href="https://istio.io/latest/docs/concepts/security/" target="_blank" rel="noopener">Istio Security Concepts</a> ‚Äî fine-grained service-to-service enforcement.</li>
      </ul>
    </div>
    <div id="section-2-quiz" class="widget"></div>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        if (window.AppSecWidgets && AppSecWidgets.FlowVisualizer) {
          AppSecWidgets.FlowVisualizer.create('section-2-flow', {
            title: 'From checkpoint to clear runway',
            steps: [
              {
                title: '1. Edge badge scan',
                description:
                  'The API gateway validates identity, device posture, and request context (BeyondCorp model) before issuing a signed pass plus trace headers.'
              },
              {
                title: '2. Policy escort into the mesh',
                description:
                  'Approved traffic is wrapped in mutual TLS, enriched with routing labels, and handed off to the service mesh entry point.'
              },
              {
                title: '3. Service-to-service clearances',
                description:
                  'Istio sidecars check the signed pass, enforce authorization policies, and apply reliability controls (rate limit, retries, circuit breakers).'
              },
              {
                title: '4. Continuous telemetry & recall',
                description:
                  'Gateway logs + mesh traces merge into a shared manifest so responders can audit every hop the way airport ops replay flight paths.'
              }
            ]
          });
        }

        if (window.AppSecWidgets && AppSecWidgets.Quiz) {
          AppSecWidgets.Quiz.create('section-2-quiz', {
            title: 'üß† Intuitive Hook Check',
            intro: 'Match the airport analogy to the zero-trust components.',
            mode: 'step',
            questions: [
              {
                text: 'In the airport analogy, what is the service mesh responsible for?',
                options: [
                  { value: 'a', label: 'Screening unvetted travelers before they enter the terminal', correct: false },
                  {
                    value: 'b',
                    label: 'Coordinating every authorized flight path and reacting to anomalies between services',
                    correct: true
                  },
                  { value: 'c', label: 'Selling tickets and baggage allowances', correct: false },
                  { value: 'd', label: 'Handling lost-and-found for customer items', correct: false }
                ]
              }
            ]
          });
        }
      });
    </script>
  </div>
</section>

<section class="card" id="section-2-1">
  <div class="card-header">2.1 Storyboarding the Hook</div>
  <div class="card-body">
    <p>To make the airport analogy actionable, storyboard the entire traveler experience and capture where the audience should feel tension. The table below maps each beat to a security objective so the hook always circles back to measurable controls.</p>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Narrative beat</th>
            <th>Security objective</th>
            <th>Evidence teams can show</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Badge swipe at the checkpoint</td>
            <td>Continuous verification (BeyondCorp) of user + device posture.</td>
            <td>Gateway policy JSON referencing device posture claims, conditional scopes.</td>
          </tr>
          <tr>
            <td>Ground crew escorts travelers to the runway</td>
            <td>Secure metadata handoff from edge trace IDs to mesh identities.</td>
            <td>Trace samples in Jaeger showing edge ‚Üí mesh correlation IDs.</td>
          </tr>
          <tr>
            <td>Air-traffic control reroutes a flight mid-air</td>
            <td>Adaptive service-to-service policy updates (Istio, Linkerd failovers).</td>
            <td>Control-plane audit logs proving policy pushes and convergence times.</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="callout callout-info">
      <strong>Facilitator tip:</strong> Pause after each beat and ask the team whether they can surface the listed evidence in minutes, not hours. If they hesitate, that is the moment to introduce observability gaps and how the gateway + mesh pairing closes them.
    </div>
    <div id="section-2-1-checklist" class="widget"></div>
    <div id="section-2-1-quiz" class="widget"></div>
    <div class="reference-list">
      <strong>References:</strong>
      <ul>
        <li><a href="https://cloud.google.com/architecture/beyondcorp" target="_blank" rel="noopener">BeyondCorp Reference Architecture</a> ‚Äî framing user/device verification.</li>
        <li><a href="https://www.jaegertracing.io/docs/" target="_blank" rel="noopener">Jaeger documentation</a> ‚Äî guidance for demonstrating trace continuity.</li>
      </ul>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        if (window.AppSecWidgets && AppSecWidgets.Checklist) {
          AppSecWidgets.Checklist.create('section-2-1-checklist', {
            title: 'Hook Storyboard Review',
            items: [
              'Each narrative beat maps to a concrete control or telemetry artifact.',
              'Product owners can explain what breaks if the gateway or mesh step is skipped.',
              'Flight-manifest analogy includes observability metrics and alert routing.',
              'Evidence artifacts are stored in version control with timestamps.',
              'Hook ends with a call-to-action for platform and service teams.'
            ]
          });
        }

        if (window.AppSecWidgets && AppSecWidgets.Quiz) {
          AppSecWidgets.Quiz.create('section-2-1-quiz', {
            title: 'Storyboard Knowledge Check',
            mode: 'classic',
            questions: [
              {
                text: 'Why insist on pairing each narrative beat with an evidence artifact?',
                options: [
                  { value: 'a', label: 'It keeps the analogy entertaining.', correct: false },
                  { value: 'b', label: 'It links intuition to controls so teams know what to instrument.', correct: true },
                  { value: 'c', label: 'It satisfies compliance requirements for storytelling.', correct: false }
                ]
              }
            ]
          });
        }
      });
    </script>
  </div>
</section>

<section class="card" id="section-2-2">
  <div class="card-header">2.2 Converting the Analogy into Action</div>
  <div class="card-body">
    <p>The hook works only if it drives a behavior change. Use the comparison below to show stakeholders what ‚Äújust an analogy‚Äù looks like versus a hook that results in concrete backlog items.</p>
    <div id="section-2-2-configdiff" class="widget"></div>
    <p>After highlighting the deltas, coach teams to document:</p>
    <ol>
      <li>What gateway or mesh control will be piloted this sprint.</li>
      <li>Who owns the telemetry to prove it worked.</li>
      <li>How the learning feeds back into threat models and onboarding guides.</li>
    </ol>
    <div class="reference-list">
      <strong>References:</strong>
      <ul>
        <li><a href="https://istio.io/latest/docs/tasks/policy-enforcement/" target="_blank" rel="noopener">Istio policy enforcement tasks</a> ‚Äî concrete activities to pair with the narrative.</li>
        <li><a href="https://sre.google/sre-book/alerting-on-slos/" target="_blank" rel="noopener">Google SRE Book, Alerting on SLOs</a> ‚Äî demonstrates how to turn stories into measurable actions.</li>
      </ul>
    </div>
    <div id="section-2-2-quiz" class="widget"></div>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        if (window.AppSecWidgets && AppSecWidgets.ConfigDiff) {
          AppSecWidgets.ConfigDiff.create('section-2-2-configdiff', {
            title: 'Analogy vs. Actionable Hook',
            beforeLabel: 'Disconnected story',
            afterLabel: 'Actionable hook',
            before: `"We are like an airport" with no data lineage, no policy backlog, and no clear owners for telemetry. Teams hear it, nod, and keep their legacy ingress.`,
            after: `"We are like an airport" anchored by a backlog item to propagate trace IDs, a mesh policy rollout plan, and a dashboard proving edge-to-mesh verification in staging.`
          });
        }

        if (window.AppSecWidgets && AppSecWidgets.Quiz) {
          AppSecWidgets.Quiz.create('section-2-2-quiz', {
            title: 'Action Conversion Quiz',
            mode: 'classic',
            questions: [
              {
                text: 'What turns an intuitive hook into an execution plan?',
                options: [
                  { value: 'a', label: 'Adding more metaphors until the audience laughs.', correct: false },
                  { value: 'b', label: 'Linking the story to explicit controls, owners, and telemetry commitments.', correct: true },
                  { value: 'c', label: 'Letting teams interpret the story in any way they want.', correct: false }
                ]
              }
            ]
          });
        }
      });
    </script>
  </div>
</section>
